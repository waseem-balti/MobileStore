{% extends "base.html" %}
{% load custom_filters %}
{% load static %}
{% load humanize %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Hero Section -->
    <div class="bg-white rounded-3xl shadow-xl overflow-hidden">
        <div class="flex flex-col lg:flex-row">
            <!-- Image Gallery Section -->
            <div class="lg:w-1/2 p-8 bg-gray-50">
              <div class="relative aspect-square mb-6">
                {% if laptop.image %}
                    <img id="mainImage" 
                         src="{{ laptop.image.url }}" 
                         alt="{{ laptop.name }}"
                         height="500" width="500"
                         class="w-full h-full object-contain rounded-2xl shadow-lg transition-all duration-500 hover:scale-105"
                    />
                {% else %}
                    <img id="mainImage" 
                         src="/path/to/default-image.jpg" 
                         alt="Default Image"
                         height="500" width="500"
                         class="w-full h-full object-contain rounded-2xl shadow-lg transition-all duration-500 hover:scale-105"
                    />
                {% endif %}
            </div>
            
            </div>

            <!-- Product Details Section -->
            <div class="lg:w-1/2 p-8 lg:pl-12 flex flex-col">
                <!-- Header -->
                <div class="mb-8">
                    <h1 class="text-4xl font-bold text-gray-900 mb-4">{{ laptop.name }}</h1>
                    <p class="text-lg text-gray-600">{{ laptop.description }}</p>
                </div>

                <!-- Price Card -->
                <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-6 rounded-2xl mb-8">
                    <div class="flex items-center justify-between">
                        <span class="text-lg font-medium text-gray-700">Price</span>
                        <span class="text-3xl font-bold text-green-600">PKR {{ laptop.price|intcomma }}</span>
                    </div>
                </div>

                <!-- Add to Cart Button -->
                <form method="post" action="{% url 'add_to_cart' 'laptop' laptop.id %}" class="mt-auto">
                    {% csrf_token %}
                    <button type="submit" 
                            class="w-full bg-blue-600 text-white py-4 px-8 rounded-xl text-lg font-semibold 
                                   hover:bg-blue-700 transform transition-all duration-300 hover:scale-105 
                                   focus:outline-none focus:ring-4 focus:ring-blue-200 active:scale-95">
                        Add to Cart
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Detailed Specifications -->
    <div class="mt-12 bg-white rounded-3xl shadow-xl p-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-8">Technical Specifications</h2>
        
        <div class="grid grid-cols-1 gap-8">
            <!-- Basic Information -->
            <div class="border-b pb-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Basic Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Brand</span>
                        <span class="font-medium text-gray-900">{{ laptop.brand }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Category</span>
                        <span class="font-medium text-gray-900">{{ laptop.category.name }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Shop Owner</span>
                        <span class="font-medium text-gray-900">{{ laptop.shop_owner.store_name }}</span>
                    </div>
                </div>
            </div>

            <!-- Display -->
            <div class="border-b pb-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Display</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Screen Size</span>
                        <span class="font-medium text-gray-900">{{ laptop.screen_size }} inches</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Resolution</span>
                        <span class="font-medium text-gray-900">{{ laptop.display_resolution }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Display Type</span>
                        <span class="font-medium text-gray-900">{{ laptop.display_type }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Refresh Rate</span>
                        <span class="font-medium text-gray-900">{{ laptop.refresh_rate }} Hz</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Touchscreen</span>
                        <span class="font-medium text-gray-900">{{ laptop.touchscreen|yesno:"Yes,No" }}</span>
                    </div>
                </div>
            </div>

            <!-- Performance -->
            <div class="border-b pb-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Performance</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Processor</span>
                        <span class="font-medium text-gray-900">{{ laptop.processor }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Processor Generation</span>
                        <span class="font-medium text-gray-900">{{ laptop.processor_generation }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">RAM</span>
                        <span class="font-medium text-gray-900">{{ laptop.ram }} GB</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Storage Type</span>
                        <span class="font-medium text-gray-900">{{ laptop.storage_type }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Storage Size</span>
                        <span class="font-medium text-gray-900">{{ laptop.storage_size }} GB</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Graphics Card</span>
                        <span class="font-medium text-gray-900">{{ laptop.graphics_card }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Graphics Memory</span>
                        <span class="font-medium text-gray-900">{{ laptop.graphics_memory }}</span>
                    </div>
                </div>
            </div>

            <!-- Battery -->
            <div class="border-b pb-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Battery</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Battery Life</span>
                        <span class="font-medium text-gray-900">{{ laptop.battery_life }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Battery Type</span>
                        <span class="font-medium text-gray-900">{{ laptop.battery_type }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Fast Charging</span>
                        <span class="font-medium text-gray-900">{{ laptop.fast_charging|yesno:"Yes,No" }}</span>
                    </div>
                </div>
            </div>

            <!-- Connectivity -->
            <div class="border-b pb-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Connectivity</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">WiFi</span>
                        <span class="font-medium text-gray-900">{{ laptop.wifi|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Bluetooth</span>
                        <span class="font-medium text-gray-900">{{ laptop.bluetooth|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">USB Ports</span>
                        <span class="font-medium text-gray-900">{{ laptop.usb_ports }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">USB Type-C</span>
                        <span class="font-medium text-gray-900">{{ laptop.usb_type_c|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">HDMI Port</span>
                        <span class="font-medium text-gray-900">{{ laptop.hdmi_port|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Ethernet Port</span>
                        <span class="font-medium text-gray-900">{{ laptop.ethernet_port|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Headphone Jack</span>
                        <span class="font-medium text-gray-900">{{ laptop.headphone_jack|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Card Reader</span>
                        <span class="font-medium text-gray-900">{{ laptop.card_reader|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Thunderbolt Support</span>
                        <span class="font-medium text-gray-900">{{ laptop.thunderbolt_support|yesno:"Yes,No" }}</span>
                    </div>
                </div>
            </div>

            <!-- Build and Features -->
            <div class="border-b pb-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Build and Features</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Dimensions</span>
                        <span class="font-medium text-gray-900">{{ laptop.dimensions }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Weight</span>
                        <span class="font-medium text-gray-900">{{ laptop.weight }} kg</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Material</span>
                        <span class="font-medium text-gray-900">{{ laptop.material }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Color Options</span>
                        <span class="font-medium text-gray-900">{{ laptop.color_options }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Backlit Keyboard</span>
                        <span class="font-medium text-gray-900">{{ laptop.backlit_keyboard|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Fingerprint Reader</span>
                        <span class="font-medium text-gray-900">{{ laptop.fingerprint_reader|yesno:"Yes,No" }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Webcam Resolution</span>
                        <span class="font-medium text-gray-900">{{ laptop.webcam_resolution }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Audio Features</span>
                        <span class="font-medium text-gray-900">{{ laptop.audio_features }}</span>
                    </div>
                </div>
            </div>

            <!-- Miscellaneous -->
            <div class="border-b pb-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Miscellaneous</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Operating System</span>
                        <span class="font-medium text-gray-900">{{ laptop.os }}</span>
                    </div>
                    <div class="flex justify-between py-2 border-b">
                        <span class="text-gray-600">Availability</span>
                        <span class="font-medium text-gray-900">{{ laptop.is_available|yesno:"Available,Not Available" }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    <!-- Reviews Section -->
    <div class="mt-16">
      <h3 class="text-3xl font-bold mb-8 text-gray-900">Customer Reviews</h3>
      {% if reviews %}
        <div class="grid gap-6">
          {% for review in reviews %}
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 hover:shadow-lg">
              <div class="flex justify-between items-center mb-4">
                <div class="flex items-center space-x-4">
                  <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                    <span class="text-xl font-bold text-green-600">{{ review.user.username|make_list|first }}</span>
                  </div>
                  <div>
                    <h4 class="font-semibold text-gray-900">{{ review.user.username }}</h4>
                    <p class="text-sm text-gray-500">{{ review.created_at|date:"D M d, Y" }}</p>
                  </div>
                </div>
                <div class="flex">
                  {% for i in rating_range %}
                    <svg xmlns="http://www.w3.org/2000/svg"
                         width="20"
                         height="20"
                         fill="{% if i <= review.rating %}#FCD34D{% else %}#E5E7EB{% endif %}"
                         class="mr-1"
                         viewBox="0 0 16 16">
                      <path d="M3.612 15.443c-.396.217-.878-.115-.786-.545l1.135-4.442L.173 6.545c-.39-.38-.188-1.031.35-1.092l4.511-.335L7.9.473c.216-.611.962-.611 1.178 0l2.285 4.64 4.505.335c.538.061.738.712.348 1.092l-3.788 4.411 1.128 4.442c.092.43-.39.762-.786.545l-4.43-2.586-4.43 2.586z" />
                    </svg>
                  {% endfor %}
                </div>
              </div>
              <p class="text-gray-700 leading-relaxed">{{ review.review_text }}</p>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="bg-gray-50 rounded-xl p-8 text-center">
          <p class="text-gray-600 text-lg">No reviews yet. Be the first to share your experience!</p>
        </div>
      {% endif %}
    </div>
<!-- Add Review Form -->
<div class="mt-16 mb-8">
  <h4 class="text-2xl font-bold mb-6 text-gray-900">Write a Review</h4>
  <form method="post" class="bg-white rounded-xl shadow-lg p-8">
      {% csrf_token %}
      <div class="space-y-6">
          <div>
              <label for="rating" class="block text-lg font-medium text-gray-700 mb-4">Rating</label>
              <div class="flex space-x-4">
                  {% for i in rating_range %}
                  <label class="relative">
                      <input type="radio" name="rating" value="{{ i }}" class="hidden peer" {% if form.rating.value == i %}checked{% endif %}>
                      <div class="w-12 h-12 flex items-center justify-center rounded-lg border-2 border-gray-200 cursor-pointer peer-checked:border-green-500 peer-checked:bg-green-50">
                          <span class="text-xl font-semibold text-gray-700 peer-checked:text-green-600">{{ i }}</span>
                      </div>
                  </label>
                  {% endfor %}
              </div>
              {% if form.rating.errors %}
                  <div class="text-red-500 text-sm mt-1">{{ form.rating.errors }}</div>
              {% endif %}
          </div>

          <div>
              <label for="review_text" class="block text-lg font-medium text-gray-700 mb-2">Your Review</label>
              {{ form.review_text }}
              {% if form.review_text.errors %}
                  <div class="text-red-500 text-sm mt-1">{{ form.review_text.errors }}</div>
              {% endif %}
          </div>

          <button type="submit" 
                  class="w-full bg-green-600 text-white py-4 px-8 rounded-xl text-lg font-semibold hover:bg-green-700 transform transition-all duration-300 hover:scale-[1.02] focus:outline-none focus:ring-4 focus:ring-green-200">
              Submit Review
          </button>
      </div>
  </form>
</div>

<!-- JavaScript to update the main image on hover -->
  <script>
  function updatePreview(imageUrl) {
    const previewImage = document.getElementById("previewImage");
    previewImage.src = imageUrl;

    // Add fade effect
    previewImage.style.opacity = "0";
    setTimeout(() => {
      previewImage.style.opacity = "1";
    }, 100);
  }

  // Initialize preview image transition
  const previewImage = document.getElementById("previewImage");
  previewImage.style.transition = "all 0.3s ease-in-out";
  </script>
{% endblock content %}
